# data table

BEGIN_PGML
[#
    [. [`x`] .]
    [% comment in table %]
    [. [`x^2`] .]*
    [. [`2`] .]
    [. [_]{4} .]
#]
END_PGML

==>

{
    "name": "Program",
    "from": 0,
    "to": 120,
    "children": [
        {
            "name": "PGMLBlock",
            "from": 0,
            "to": 120,
            "children": [
                { "name": "BeginPG", "from": 0, "to": 10 },
                {
                    "name": "PGMLContent",
                    "from": 10,
                    "to": 112,
                    "children": [
                        {
                            "name": "Paragraph",
                            "from": 10,
                            "to": 112,
                            "children": [
                                {
                                    "name": "Table",
                                    "from": 11,
                                    "to": 111,
                                    "children": [
                                        { "name": "TableMark", "from": 11, "to": 13 },
                                        {
                                            "name": "TableCell",
                                            "from": 18,
                                            "to": 29,
                                            "children": [
                                                { "name": "TableCellMark", "from": 18, "to": 20 },
                                                {
                                                    "name": "MathMode",
                                                    "from": 21,
                                                    "to": 26,
                                                    "children": [
                                                        { "name": "MathModeMark", "from": 21, "to": 23 },
                                                        { "name": "MathModeMark", "from": 24, "to": 26 }
                                                    ]
                                                },
                                                { "name": "TableCellMark", "from": 27, "to": 29 }
                                            ]
                                        },
                                        { "name": "Comment", "from": 34, "to": 56 },
                                        {
                                            "name": "TableCell",
                                            "from": 61,
                                            "to": 75,
                                            "children": [
                                                { "name": "TableCellMark", "from": 61, "to": 63 },
                                                {
                                                    "name": "MathMode",
                                                    "from": 64,
                                                    "to": 71,
                                                    "children": [
                                                        { "name": "MathModeMark", "from": 64, "to": 66 },
                                                        { "name": "MathModeMark", "from": 69, "to": 71 }
                                                    ]
                                                },
                                                { "name": "TableCellMark", "from": 72, "to": 75 }
                                            ]
                                        },
                                        {
                                            "name": "TableCell",
                                            "from": 80,
                                            "to": 91,
                                            "children": [
                                                { "name": "TableCellMark", "from": 80, "to": 82 },
                                                {
                                                    "name": "MathMode",
                                                    "from": 83,
                                                    "to": 88,
                                                    "children": [
                                                        { "name": "MathModeMark", "from": 83, "to": 85 },
                                                        { "name": "MathModeMark", "from": 86, "to": 88 }
                                                    ]
                                                },
                                                { "name": "TableCellMark", "from": 89, "to": 91 }
                                            ]
                                        },
                                        {
                                            "name": "TableCell",
                                            "from": 96,
                                            "to": 108,
                                            "children": [
                                                { "name": "TableCellMark", "from": 96, "to": 98 },
                                                { "name": "AnswerRule", "from": 99, "to": 102 },
                                                {
                                                    "name": "Option",
                                                    "from": 102,
                                                    "to": 105,
                                                    "children": [
                                                        { "name": "OptionMark", "from": 102, "to": 103 },
                                                        {
                                                            "name": "Program",
                                                            "from": 103,
                                                            "to": 104,
                                                            "children": [
                                                                {
                                                                    "name": "ExpressionStatement",
                                                                    "from": 103,
                                                                    "to": 104,
                                                                    "children": [
                                                                        { "name": "Integer", "from": 103, "to": 104 }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        { "name": "OptionMark", "from": 104, "to": 105 }
                                                    ]
                                                },
                                                { "name": "TableCellMark", "from": 106, "to": 108 }
                                            ]
                                        },
                                        { "name": "TableMark", "from": 109, "to": 111 }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                { "name": "EndPG", "from": 112, "to": 120 }
            ]
        }
    ]
}

==>

from: '0'
parseAll: 'true'
to: '101'
type: 'root'
stack: [
  [ # 0
    combine: { indent: 'indent', list: { indent: '1' }, par: 'true' }
    from: '0'
    indent: '0'
    to: '101'
    type: 'indent'
    stack: [
      [ # 0
        allowPar: 'true'
        allowStar: 'true'
        from: '0'
        options: ['center', 'caption', 'horizontalrules', 'texalignment', 'align', 'Xratio', 'encase', 'rowheaders', 'headerrules', 'valign', 'padding', 'tablecss', 'captioncss', 'columnscss', 'datacss', 'headercss', 'allcellcss', 'booktabs']
        terminator: '#]'
        to: '100'
        token: '[#'
        type: 'table'
        stack: [
          [ # 0
            allowStar: 'true'
            container: 'table'
            from: '7'
            isContainer: 'true'
            options: ['halign', 'header', 'color', 'bgcolor', 'b', 'i', 'm', 'noencase', 'colspan', 'top', 'bottom', 'cellcss', 'texpre', 'texpost', 'texencase', 'rowcolor', 'rowcss', 'headerrow', 'rowtop', 'rowbottom', 'valign', 'rows']
            terminator: '.]'
            to: '18'
            token: '[.'
            type: 'table-cell'
            stack: [
              [ # 0
                combine: { text: 'type' }
                from: '9'
                to: '10'
                type: 'text'
                stack: [' ']
              ]
              [ # 1
                children: [
                  {
                    combine: { text: 'type' }
                    from: '12'
                    to: '13'
                    type: 'text'
                    stack: ['x']
                  }
                ]
                containerEnd: '/\.\]/'
                from: '10'
                terminator: '`]'
                to: '15'
                token: '[`'
                type: 'math'
              ]
              [ # 2
                combine: { text: 'type' }
                from: '15'
                to: '16'
                type: 'text'
                stack: [' ']
              ]
            ]
          ]
          [ # 1
            allowPar: 'true'
            from: '23'
            terminator: '%]'
            to: '45'
            token: '[%'
            type: 'comment'
            stack: [
              [ # 0
                combine: { text: 'type' }
                from: '25'
                to: '43'
                type: 'text'
                stack: [' comment in table ']
              ]
            ]
          ]
          [ # 2
            allowStar: 'true'
            container: 'table'
            from: '50'
            hasStar: '1'
            isContainer: 'true'
            options: ['halign', 'header', 'color', 'bgcolor', 'b', 'i', 'm', 'noencase', 'colspan', 'top', 'bottom', 'cellcss', 'texpre', 'texpost', 'texencase', 'rowcolor', 'rowcss', 'headerrow', 'rowtop', 'rowbottom', 'valign', 'rows']
            terminator: '.]'
            to: '64'
            token: '[.'
            type: 'table-cell'
            stack: [
              [ # 0
                combine: { text: 'type' }
                from: '52'
                to: '53'
                type: 'text'
                stack: [' ']
              ]
              [ # 1
                children: [
                  {
                    combine: { text: 'type' }
                    from: '55'
                    to: '58'
                    type: 'text'
                    stack: ['x^2']
                  }
                ]
                containerEnd: '/\.\]/'
                from: '53'
                terminator: '`]'
                to: '60'
                token: '[`'
                type: 'math'
              ]
              [ # 2
                combine: { text: 'type' }
                from: '60'
                to: '61'
                type: 'text'
                stack: [' ']
              ]
            ]
          ]
          [ # 3
            allowStar: 'true'
            container: 'table'
            from: '69'
            isContainer: 'true'
            options: ['halign', 'header', 'color', 'bgcolor', 'b', 'i', 'm', 'noencase', 'colspan', 'top', 'bottom', 'cellcss', 'texpre', 'texpost', 'texencase', 'rowcolor', 'rowcss', 'headerrow', 'rowtop', 'rowbottom', 'valign', 'rows']
            terminator: '.]'
            to: '80'
            token: '[.'
            type: 'table-cell'
            stack: [
              [ # 0
                combine: { text: 'type' }
                from: '71'
                to: '72'
                type: 'text'
                stack: [' ']
              ]
              [ # 1
                children: [
                  {
                    combine: { text: 'type' }
                    from: '74'
                    to: '75'
                    type: 'text'
                    stack: ['2']
                  }
                ]
                containerEnd: '/\.\]/'
                from: '72'
                terminator: '`]'
                to: '77'
                token: '[`'
                type: 'math'
              ]
              [ # 2
                combine: { text: 'type' }
                from: '77'
                to: '78'
                type: 'text'
                stack: [' ']
              ]
            ]
          ]
          [ # 4
            allowStar: 'true'
            container: 'table'
            from: '85'
            isContainer: 'true'
            options: ['halign', 'header', 'color', 'bgcolor', 'b', 'i', 'm', 'noencase', 'colspan', 'top', 'bottom', 'cellcss', 'texpre', 'texpost', 'texencase', 'rowcolor', 'rowcss', 'headerrow', 'rowtop', 'rowbottom', 'valign', 'rows']
            terminator: '.]'
            to: '97'
            token: '[.'
            type: 'table-cell'
            stack: [
              [ # 0
                combine: { text: 'type' }
                from: '87'
                to: '88'
                type: 'text'
                stack: [' ']
              ]
              [ # 1
                from: '88'
                optionStack: [
                  {
                    containerEnd: '/\.\]/'
                    from: '91'
                    terminator: '}'
                    text: '4'
                    to: '94'
                    token: '{'
                    type: 'options'
                  }
                ]
                options: ['answer', 'width', 'name', 'cmp_options']
                to: '94'
                token: '[_]'
                type: 'answer'
              ]
              [ # 2
                combine: { text: 'type' }
                from: '94'
                to: '95'
                type: 'text'
                stack: [' ']
              ]
            ]
          ]
        ]
      ]
    ]
  ]
]

# layout table

BEGIN_PGML
[#
	[. Some text .]
	[. [!The WeBWorK logo!]{'webwork_logo.png'} .]*

	[.
		[#
			[. [`x`] .]
			[. [`x^2`] .]*{ headerrow => 1 }
			[. [`2`] .]
			[. [_]{4} .]
		#]
	.]
#]*
END_PGML

==>

{
    "name": "Program",
    "from": 0,
    "to": 193,
    "children": [
        {
            "name": "PGMLBlock",
            "from": 0,
            "to": 193,
            "children": [
                { "name": "BeginPG", "from": 0, "to": 10 },
                {
                    "name": "PGMLContent",
                    "from": 10,
                    "to": 185,
                    "children": [
                        {
                            "name": "Paragraph",
                            "from": 10,
                            "to": 185,
                            "children": [
                                {
                                    "name": "Table",
                                    "from": 11,
                                    "to": 184,
                                    "children": [
                                        { "name": "TableMark", "from": 11, "to": 13 },
                                        {
                                            "name": "TableCell",
                                            "from": 15,
                                            "to": 30,
                                            "children": [
                                                { "name": "TableCellMark", "from": 15, "to": 17 },
                                                { "name": "TableCellMark", "from": 28, "to": 30 }
                                            ]
                                        },
                                        {
                                            "name": "TableCell",
                                            "from": 32,
                                            "to": 79,
                                            "children": [
                                                { "name": "TableCellMark", "from": 32, "to": 34 },
                                                {
                                                    "name": "Image",
                                                    "from": 35,
                                                    "to": 55,
                                                    "children": [
                                                        { "name": "ImageMark", "from": 35, "to": 37 },
                                                        { "name": "ImageMark", "from": 53, "to": 55 }
                                                    ]
                                                },
                                                {
                                                    "name": "Option",
                                                    "from": 55,
                                                    "to": 75,
                                                    "children": [
                                                        { "name": "OptionMark", "from": 55, "to": 56 },
                                                        {
                                                            "name": "Program",
                                                            "from": 56,
                                                            "to": 74,
                                                            "children": [
                                                                {
                                                                    "name": "ExpressionStatement",
                                                                    "from": 56,
                                                                    "to": 74,
                                                                    "children": [
                                                                        { "name": "StringSingleQuoted", "from": 56, "to": 74 }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        { "name": "OptionMark", "from": 74, "to": 75 }
                                                    ]
                                                },
                                                { "name": "TableCellMark", "from": 76, "to": 79 }
                                            ]
                                        },
                                        {
                                            "name": "TableCell",
                                            "from": 82,
                                            "to": 180,
                                            "children": [
                                                { "name": "TableCellMark", "from": 82, "to": 84 },
                                                {
                                                    "name": "Table",
                                                    "from": 87,
                                                    "to": 176,
                                                    "children": [
                                                        { "name": "TableMark", "from": 87, "to": 89 },
                                                        {
                                                            "name": "TableCell",
                                                            "from": 93,
                                                            "to": 104,
                                                            "children": [
                                                                { "name": "TableCellMark", "from": 93, "to": 95 },
                                                                {
                                                                    "name": "MathMode",
                                                                    "from": 96,
                                                                    "to": 101,
                                                                    "children": [
                                                                        { "name": "MathModeMark", "from": 96, "to": 98 },
                                                                        { "name": "MathModeMark", "from": 99, "to": 101 }
                                                                    ]
                                                                },
                                                                { "name": "TableCellMark", "from": 102, "to": 104 }
                                                            ]
                                                        },
                                                        {
                                                            "name": "TableCell",
                                                            "from": 108,
                                                            "to": 122,
                                                            "children": [
                                                                { "name": "TableCellMark", "from": 108, "to": 110 },
                                                                {
                                                                    "name": "MathMode",
                                                                    "from": 111,
                                                                    "to": 118,
                                                                    "children": [
                                                                        { "name": "MathModeMark", "from": 111, "to": 113 },
                                                                        { "name": "MathModeMark", "from": 116, "to": 118 }
                                                                    ]
                                                                },
                                                                { "name": "TableCellMark", "from": 119, "to": 122 }
                                                            ]
                                                        },
                                                        {
                                                            "name": "Option",
                                                            "from": 122,
                                                            "to": 140,
                                                            "children": [
                                                                { "name": "OptionMark", "from": 122, "to": 123 },
                                                                {
                                                                    "name": "Program",
                                                                    "from": 123,
                                                                    "to": 139,
                                                                    "children": [
                                                                        {
                                                                            "name": "ExpressionStatement",
                                                                            "from": 124,
                                                                            "to": 138,
                                                                            "children": [
                                                                                {
                                                                                    "name": "Pair",
                                                                                    "from": 124,
                                                                                    "to": 138,
                                                                                    "children": [
                                                                                        { "name": "Identifier", "from": 124, "to": 133 },
                                                                                        { "name": "FatComma", "from": 134, "to": 136 },
                                                                                        { "name": "Integer", "from": 137, "to": 138 }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                { "name": "OptionMark", "from": 139, "to": 140 }
                                                            ]
                                                        },
                                                        {
                                                            "name": "TableCell",
                                                            "from": 144,
                                                            "to": 155,
                                                            "children": [
                                                                { "name": "TableCellMark", "from": 144, "to": 146 },
                                                                {
                                                                    "name": "MathMode",
                                                                    "from": 147,
                                                                    "to": 152,
                                                                    "children": [
                                                                        { "name": "MathModeMark", "from": 147, "to": 149 },
                                                                        { "name": "MathModeMark", "from": 150, "to": 152 }
                                                                    ]
                                                                },
                                                                { "name": "TableCellMark", "from": 153, "to": 155 }
                                                            ]
                                                        },
                                                        {
                                                            "name": "TableCell",
                                                            "from": 159,
                                                            "to": 171,
                                                            "children": [
                                                                { "name": "TableCellMark", "from": 159, "to": 161 },
                                                                { "name": "AnswerRule", "from": 162, "to": 165 },
                                                                {
                                                                    "name": "Option",
                                                                    "from": 165,
                                                                    "to": 168,
                                                                    "children": [
                                                                        { "name": "OptionMark", "from": 165, "to": 166 },
                                                                        {
                                                                            "name": "Program",
                                                                            "from": 166,
                                                                            "to": 167,
                                                                            "children": [
                                                                                {
                                                                                    "name": "ExpressionStatement",
                                                                                    "from": 166,
                                                                                    "to": 167,
                                                                                    "children": [
                                                                                        { "name": "Integer", "from": 166, "to": 167 }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        { "name": "OptionMark", "from": 167, "to": 168 }
                                                                    ]
                                                                },
                                                                { "name": "TableCellMark", "from": 169, "to": 171 }
                                                            ]
                                                        },
                                                        { "name": "TableMark", "from": 174, "to": 176 }
                                                    ]
                                                },
                                                { "name": "TableCellMark", "from": 178, "to": 180 }
                                            ]
                                        },
                                        { "name": "TableMark", "from": 181, "to": 184 }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                { "name": "EndPG", "from": 185, "to": 193 }
            ]
        }
    ]
}

==>

from: '0'
parseAll: 'true'
to: '174'
type: 'root'
stack: [
  [ # 0
    combine: { indent: 'indent', list: { indent: '1' }, par: 'true' }
    from: '0'
    indent: '0'
    to: '174'
    type: 'indent'
    stack: [
      [ # 0
        allowPar: 'true'
        allowStar: 'true'
        from: '0'
        hasStar: '1'
        options: ['center', 'caption', 'horizontalrules', 'texalignment', 'align', 'Xratio', 'encase', 'rowheaders', 'headerrules', 'valign', 'padding', 'tablecss', 'captioncss', 'columnscss', 'datacss', 'headercss', 'allcellcss', 'booktabs']
        terminator: '#]'
        to: '173'
        token: '[#'
        type: 'table'
        stack: [
          [ # 0
            allowStar: 'true'
            container: 'table'
            from: '4'
            isContainer: 'true'
            options: ['halign', 'header', 'color', 'bgcolor', 'b', 'i', 'm', 'noencase', 'colspan', 'top', 'bottom', 'cellcss', 'texpre', 'texpost', 'texencase', 'rowcolor', 'rowcss', 'headerrow', 'rowtop', 'rowbottom', 'valign', 'rows']
            terminator: '.]'
            to: '19'
            token: '[.'
            type: 'table-cell'
            stack: [
              [ # 0
                combine: { text: 'type' }
                from: '6'
                to: '17'
                type: 'text'
                stack: [' Some text ']
              ]
            ]
          ]
          [ # 1
            allowStar: 'true'
            container: 'table'
            from: '21'
            hasStar: '1'
            isContainer: 'true'
            options: ['halign', 'header', 'color', 'bgcolor', 'b', 'i', 'm', 'noencase', 'colspan', 'top', 'bottom', 'cellcss', 'texpre', 'texpost', 'texencase', 'rowcolor', 'rowcss', 'headerrow', 'rowtop', 'rowbottom', 'valign', 'rows']
            terminator: '.]'
            to: '68'
            token: '[.'
            type: 'table-cell'
            stack: [
              [ # 0
                combine: { text: 'type' }
                from: '23'
                to: '24'
                type: 'text'
                stack: [' ']
              ]
              [ # 1
                children: [
                  {
                    combine: { text: 'type' }
                    from: '26'
                    to: '42'
                    type: 'text'
                    stack: ['The WeBWorK logo']
                  }
                ]
                containerEnd: '/\.\]/'
                from: '24'
                optionStack: [
                  {
                    containerEnd: '/\.\]/'
                    from: '44'
                    terminator: '}'
                    text: ''webwork_logo.png''
                    to: '64'
                    token: '{'
                    type: 'options'
                  }
                ]
                options: ['source', 'width', 'height', 'image_options']
                terminator: '!]'
                to: '64'
                token: '[!'
                type: 'image'
              ]
              [ # 2
                combine: { text: 'type' }
                from: '64'
                to: '65'
                type: 'text'
                stack: [' ']
              ]
            ]
          ]
          [ # 2
            allowStar: 'true'
            container: 'table'
            from: '71'
            isContainer: 'true'
            options: ['halign', 'header', 'color', 'bgcolor', 'b', 'i', 'm', 'noencase', 'colspan', 'top', 'bottom', 'cellcss', 'texpre', 'texpost', 'texencase', 'rowcolor', 'rowcss', 'headerrow', 'rowtop', 'rowbottom', 'valign', 'rows']
            terminator: '.]'
            to: '169'
            token: '[.'
            type: 'table-cell'
            stack: [
              [ # 0
                combine: { text: 'type' }
                from: '73'
                to: '76'
                type: 'text'
                stack: ['\n']
              ]
              [ # 1
                allowPar: 'true'
                allowStar: 'true'
                containerEnd: '/\.\]/'
                from: '76'
                options: ['center', 'caption', 'horizontalrules', 'texalignment', 'align', 'Xratio', 'encase', 'rowheaders', 'headerrules', 'valign', 'padding', 'tablecss', 'captioncss', 'columnscss', 'datacss', 'headercss', 'allcellcss', 'booktabs']
                terminator: '#]'
                to: '165'
                token: '[#'
                type: 'table'
                stack: [
                  [ # 0
                    allowStar: 'true'
                    container: 'table'
                    containerEnd: '/\.\]/'
                    from: '82'
                    isContainer: 'true'
                    options: ['halign', 'header', 'color', 'bgcolor', 'b', 'i', 'm', 'noencase', 'colspan', 'top', 'bottom', 'cellcss', 'texpre', 'texpost', 'texencase', 'rowcolor', 'rowcss', 'headerrow', 'rowtop', 'rowbottom', 'valign', 'rows']
                    terminator: '.]'
                    to: '93'
                    token: '[.'
                    type: 'table-cell'
                    stack: [
                      [ # 0
                        combine: { text: 'type' }
                        from: '84'
                        to: '85'
                        type: 'text'
                        stack: [' ']
                      ]
                      [ # 1
                        children: [
                          {
                            combine: { text: 'type' }
                            from: '87'
                            to: '88'
                            type: 'text'
                            stack: ['x']
                          }
                        ]
                        containerEnd: '/\.\]/'
                        from: '85'
                        terminator: '`]'
                        to: '90'
                        token: '[`'
                        type: 'math'
                      ]
                      [ # 2
                        combine: { text: 'type' }
                        from: '90'
                        to: '91'
                        type: 'text'
                        stack: [' ']
                      ]
                    ]
                  ]
                  [ # 1
                    allowStar: 'true'
                    container: 'table'
                    containerEnd: '/\.\]/'
                    from: '97'
                    hasStar: '1'
                    isContainer: 'true'
                    optionStack: [
                      {
                        containerEnd: '/\.\]/'
                        from: '111'
                        terminator: '}'
                        text: ' headerrow => 1 '
                        to: '129'
                        token: '{'
                        type: 'options'
                      }
                    ]
                    options: ['halign', 'header', 'color', 'bgcolor', 'b', 'i', 'm', 'noencase', 'colspan', 'top', 'bottom', 'cellcss', 'texpre', 'texpost', 'texencase', 'rowcolor', 'rowcss', 'headerrow', 'rowtop', 'rowbottom', 'valign', 'rows']
                    terminator: '.]'
                    to: '129'
                    token: '[.'
                    type: 'table-cell'
                    stack: [
                      [ # 0
                        combine: { text: 'type' }
                        from: '99'
                        to: '100'
                        type: 'text'
                        stack: [' ']
                      ]
                      [ # 1
                        children: [
                          {
                            combine: { text: 'type' }
                            from: '102'
                            to: '105'
                            type: 'text'
                            stack: ['x^2']
                          }
                        ]
                        containerEnd: '/\.\]/'
                        from: '100'
                        terminator: '`]'
                        to: '107'
                        token: '[`'
                        type: 'math'
                      ]
                      [ # 2
                        combine: { text: 'type' }
                        from: '107'
                        to: '108'
                        type: 'text'
                        stack: [' ']
                      ]
                    ]
                  ]
                  [ # 2
                    allowStar: 'true'
                    container: 'table'
                    containerEnd: '/\.\]/'
                    from: '133'
                    isContainer: 'true'
                    options: ['halign', 'header', 'color', 'bgcolor', 'b', 'i', 'm', 'noencase', 'colspan', 'top', 'bottom', 'cellcss', 'texpre', 'texpost', 'texencase', 'rowcolor', 'rowcss', 'headerrow', 'rowtop', 'rowbottom', 'valign', 'rows']
                    terminator: '.]'
                    to: '144'
                    token: '[.'
                    type: 'table-cell'
                    stack: [
                      [ # 0
                        combine: { text: 'type' }
                        from: '135'
                        to: '136'
                        type: 'text'
                        stack: [' ']
                      ]
                      [ # 1
                        children: [
                          {
                            combine: { text: 'type' }
                            from: '138'
                            to: '139'
                            type: 'text'
                            stack: ['2']
                          }
                        ]
                        containerEnd: '/\.\]/'
                        from: '136'
                        terminator: '`]'
                        to: '141'
                        token: '[`'
                        type: 'math'
                      ]
                      [ # 2
                        combine: { text: 'type' }
                        from: '141'
                        to: '142'
                        type: 'text'
                        stack: [' ']
                      ]
                    ]
                  ]
                  [ # 3
                    allowStar: 'true'
                    container: 'table'
                    containerEnd: '/\.\]/'
                    from: '148'
                    isContainer: 'true'
                    options: ['halign', 'header', 'color', 'bgcolor', 'b', 'i', 'm', 'noencase', 'colspan', 'top', 'bottom', 'cellcss', 'texpre', 'texpost', 'texencase', 'rowcolor', 'rowcss', 'headerrow', 'rowtop', 'rowbottom', 'valign', 'rows']
                    terminator: '.]'
                    to: '160'
                    token: '[.'
                    type: 'table-cell'
                    stack: [
                      [ # 0
                        combine: { text: 'type' }
                        from: '150'
                        to: '151'
                        type: 'text'
                        stack: [' ']
                      ]
                      [ # 1
                        from: '151'
                        optionStack: [
                          {
                            containerEnd: '/\.\]/'
                            from: '154'
                            terminator: '}'
                            text: '4'
                            to: '157'
                            token: '{'
                            type: 'options'
                          }
                        ]
                        options: ['answer', 'width', 'name', 'cmp_options']
                        to: '157'
                        token: '[_]'
                        type: 'answer'
                      ]
                      [ # 2
                        combine: { text: 'type' }
                        from: '157'
                        to: '158'
                        type: 'text'
                        stack: [' ']
                      ]
                    ]
                  ]
                ]
              ]
            ]
          ]
        ]
      ]
    ]
  ]
]

# data table with options

BEGIN_PGML
[#
	[. [`x`] .] [. [`x^2`] .]*
	[. [`1`] .] [. [_]{1} .]
#]{ center => 0, align => '|c|c|', horizontalrules => 1 }
END_PGML

==>

{
    "name": "Program",
    "from": 0,
    "to": 134,
    "children": [
        {
            "name": "PGMLBlock",
            "from": 0,
            "to": 134,
            "children": [
                { "name": "BeginPG", "from": 0, "to": 10 },
                {
                    "name": "PGMLContent",
                    "from": 10,
                    "to": 126,
                    "children": [
                        {
                            "name": "Paragraph",
                            "from": 10,
                            "to": 126,
                            "children": [
                                {
                                    "name": "Table",
                                    "from": 11,
                                    "to": 70,
                                    "children": [
                                        { "name": "TableMark", "from": 11, "to": 13 },
                                        {
                                            "name": "TableCell",
                                            "from": 15,
                                            "to": 26,
                                            "children": [
                                                { "name": "TableCellMark", "from": 15, "to": 17 },
                                                {
                                                    "name": "MathMode",
                                                    "from": 18,
                                                    "to": 23,
                                                    "children": [
                                                        { "name": "MathModeMark", "from": 18, "to": 20 },
                                                        { "name": "MathModeMark", "from": 21, "to": 23 }
                                                    ]
                                                },
                                                { "name": "TableCellMark", "from": 24, "to": 26 }
                                            ]
                                        },
                                        {
                                            "name": "TableCell",
                                            "from": 27,
                                            "to": 41,
                                            "children": [
                                                { "name": "TableCellMark", "from": 27, "to": 29 },
                                                {
                                                    "name": "MathMode",
                                                    "from": 30,
                                                    "to": 37,
                                                    "children": [
                                                        { "name": "MathModeMark", "from": 30, "to": 32 },
                                                        { "name": "MathModeMark", "from": 35, "to": 37 }
                                                    ]
                                                },
                                                { "name": "TableCellMark", "from": 38, "to": 41 }
                                            ]
                                        },
                                        {
                                            "name": "TableCell",
                                            "from": 43,
                                            "to": 54,
                                            "children": [
                                                { "name": "TableCellMark", "from": 43, "to": 45 },
                                                {
                                                    "name": "MathMode",
                                                    "from": 46,
                                                    "to": 51,
                                                    "children": [
                                                        { "name": "MathModeMark", "from": 46, "to": 48 },
                                                        { "name": "MathModeMark", "from": 49, "to": 51 }
                                                    ]
                                                },
                                                { "name": "TableCellMark", "from": 52, "to": 54 }
                                            ]
                                        },
                                        {
                                            "name": "TableCell",
                                            "from": 55,
                                            "to": 67,
                                            "children": [
                                                { "name": "TableCellMark", "from": 55, "to": 57 },
                                                { "name": "AnswerRule", "from": 58, "to": 61 },
                                                {
                                                    "name": "Option",
                                                    "from": 61,
                                                    "to": 64,
                                                    "children": [
                                                        { "name": "OptionMark", "from": 61, "to": 62 },
                                                        {
                                                            "name": "Program",
                                                            "from": 62,
                                                            "to": 63,
                                                            "children": [
                                                                {
                                                                    "name": "ExpressionStatement",
                                                                    "from": 62,
                                                                    "to": 63,
                                                                    "children": [
                                                                        { "name": "Integer", "from": 62, "to": 63 }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        { "name": "OptionMark", "from": 63, "to": 64 }
                                                    ]
                                                },
                                                { "name": "TableCellMark", "from": 65, "to": 67 }
                                            ]
                                        },
                                        { "name": "TableMark", "from": 68, "to": 70 }
                                    ]
                                },
                                {
                                    "name": "Option",
                                    "from": 70,
                                    "to": 125,
                                    "children": [
                                        { "name": "OptionMark", "from": 70, "to": 71 },
                                        {
                                            "name": "Program",
                                            "from": 71,
                                            "to": 124,
                                            "children": [
                                                {
                                                    "name": "ExpressionStatement",
                                                    "from": 72,
                                                    "to": 123,
                                                    "children": [
                                                        {
                                                            "name": "Pair",
                                                            "from": 72,
                                                            "to": 83,
                                                            "children": [
                                                                { "name": "Identifier", "from": 72, "to": 78 },
                                                                { "name": "FatComma", "from": 79, "to": 81 },
                                                                { "name": "Integer", "from": 82, "to": 83 }
                                                            ]
                                                        },
                                                        { "name": "Comma", "from": 83, "to": 84 },
                                                        {
                                                            "name": "Pair",
                                                            "from": 85,
                                                            "to": 101,
                                                            "children": [
                                                                { "name": "Identifier", "from": 85, "to": 90 },
                                                                { "name": "FatComma", "from": 91, "to": 93 },
                                                                { "name": "StringSingleQuoted", "from": 94, "to": 101 }
                                                            ]
                                                        },
                                                        { "name": "Comma", "from": 101, "to": 102 },
                                                        {
                                                            "name": "Pair",
                                                            "from": 103,
                                                            "to": 123,
                                                            "children": [
                                                                { "name": "Identifier", "from": 103, "to": 118 },
                                                                { "name": "FatComma", "from": 119, "to": 121 },
                                                                { "name": "Integer", "from": 122, "to": 123 }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        { "name": "OptionMark", "from": 124, "to": 125 }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                { "name": "EndPG", "from": 126, "to": 134 }
            ]
        }
    ]
}

==>

from: '0'
parseAll: 'true'
to: '115'
type: 'root'
stack: [
  [ # 0
    combine: { indent: 'indent', list: { indent: '1' }, par: 'true' }
    from: '0'
    indent: '0'
    to: '115'
    type: 'indent'
    stack: [
      [ # 0
        allowPar: 'true'
        allowStar: 'true'
        from: '0'
        optionStack: [
          {
            from: '59'
            terminator: '}'
            text: ' center => 0, align => '|c|c|', horizontalrules => 1 '
            to: '114'
            token: '{'
            type: 'options'
          }
        ]
        options: ['center', 'caption', 'horizontalrules', 'texalignment', 'align', 'Xratio', 'encase', 'rowheaders', 'headerrules', 'valign', 'padding', 'tablecss', 'captioncss', 'columnscss', 'datacss', 'headercss', 'allcellcss', 'booktabs']
        terminator: '#]'
        to: '114'
        token: '[#'
        type: 'table'
        stack: [
          [ # 0
            allowStar: 'true'
            container: 'table'
            from: '4'
            isContainer: 'true'
            options: ['halign', 'header', 'color', 'bgcolor', 'b', 'i', 'm', 'noencase', 'colspan', 'top', 'bottom', 'cellcss', 'texpre', 'texpost', 'texencase', 'rowcolor', 'rowcss', 'headerrow', 'rowtop', 'rowbottom', 'valign', 'rows']
            terminator: '.]'
            to: '15'
            token: '[.'
            type: 'table-cell'
            stack: [
              [ # 0
                combine: { text: 'type' }
                from: '6'
                to: '7'
                type: 'text'
                stack: [' ']
              ]
              [ # 1
                children: [
                  {
                    combine: { text: 'type' }
                    from: '9'
                    to: '10'
                    type: 'text'
                    stack: ['x']
                  }
                ]
                containerEnd: '/\.\]/'
                from: '7'
                terminator: '`]'
                to: '12'
                token: '[`'
                type: 'math'
              ]
              [ # 2
                combine: { text: 'type' }
                from: '12'
                to: '13'
                type: 'text'
                stack: [' ']
              ]
            ]
          ]
          [ # 1
            allowStar: 'true'
            container: 'table'
            from: '16'
            hasStar: '1'
            isContainer: 'true'
            options: ['halign', 'header', 'color', 'bgcolor', 'b', 'i', 'm', 'noencase', 'colspan', 'top', 'bottom', 'cellcss', 'texpre', 'texpost', 'texencase', 'rowcolor', 'rowcss', 'headerrow', 'rowtop', 'rowbottom', 'valign', 'rows']
            terminator: '.]'
            to: '30'
            token: '[.'
            type: 'table-cell'
            stack: [
              [ # 0
                combine: { text: 'type' }
                from: '18'
                to: '19'
                type: 'text'
                stack: [' ']
              ]
              [ # 1
                children: [
                  {
                    combine: { text: 'type' }
                    from: '21'
                    to: '24'
                    type: 'text'
                    stack: ['x^2']
                  }
                ]
                containerEnd: '/\.\]/'
                from: '19'
                terminator: '`]'
                to: '26'
                token: '[`'
                type: 'math'
              ]
              [ # 2
                combine: { text: 'type' }
                from: '26'
                to: '27'
                type: 'text'
                stack: [' ']
              ]
            ]
          ]
          [ # 2
            allowStar: 'true'
            container: 'table'
            from: '32'
            isContainer: 'true'
            options: ['halign', 'header', 'color', 'bgcolor', 'b', 'i', 'm', 'noencase', 'colspan', 'top', 'bottom', 'cellcss', 'texpre', 'texpost', 'texencase', 'rowcolor', 'rowcss', 'headerrow', 'rowtop', 'rowbottom', 'valign', 'rows']
            terminator: '.]'
            to: '43'
            token: '[.'
            type: 'table-cell'
            stack: [
              [ # 0
                combine: { text: 'type' }
                from: '34'
                to: '35'
                type: 'text'
                stack: [' ']
              ]
              [ # 1
                children: [
                  {
                    combine: { text: 'type' }
                    from: '37'
                    to: '38'
                    type: 'text'
                    stack: ['1']
                  }
                ]
                containerEnd: '/\.\]/'
                from: '35'
                terminator: '`]'
                to: '40'
                token: '[`'
                type: 'math'
              ]
              [ # 2
                combine: { text: 'type' }
                from: '40'
                to: '41'
                type: 'text'
                stack: [' ']
              ]
            ]
          ]
          [ # 3
            allowStar: 'true'
            container: 'table'
            from: '44'
            isContainer: 'true'
            options: ['halign', 'header', 'color', 'bgcolor', 'b', 'i', 'm', 'noencase', 'colspan', 'top', 'bottom', 'cellcss', 'texpre', 'texpost', 'texencase', 'rowcolor', 'rowcss', 'headerrow', 'rowtop', 'rowbottom', 'valign', 'rows']
            terminator: '.]'
            to: '56'
            token: '[.'
            type: 'table-cell'
            stack: [
              [ # 0
                combine: { text: 'type' }
                from: '46'
                to: '47'
                type: 'text'
                stack: [' ']
              ]
              [ # 1
                from: '47'
                optionStack: [
                  {
                    containerEnd: '/\.\]/'
                    from: '50'
                    terminator: '}'
                    text: '1'
                    to: '53'
                    token: '{'
                    type: 'options'
                  }
                ]
                options: ['answer', 'width', 'name', 'cmp_options']
                to: '53'
                token: '[_]'
                type: 'answer'
              ]
              [ # 2
                combine: { text: 'type' }
                from: '53'
                to: '54'
                type: 'text'
                stack: [' ']
              ]
            ]
          ]
        ]
      ]
      [ # 1
        combine: { text: 'type' }
        from: '114'
        to: '115'
        type: 'text'
        stack: ['\n']
      ]
    ]
  ]
]
